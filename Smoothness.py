from copy import deepcopy


def printpaths(path, newpath):
    for old, new in zip(path, newpath):
        print('[' + ', '.join('%.3f' % x for x in old) +
              '] -> [' + ', '.join('%.3f' % x for x in new) + ']')


path = [[20, 20, 20], [19.769762052591226, 19.783069080864838, 19.88231686812817], [19.087610292257814, 19.140343543983345, 19.533643869296274], [18.405458531924403, 18.497618007101853, 19.18497087046438], [17.72330677159099, 17.854892470220364, 18.836297871632482], [17.04115501125758, 17.212166933338874, 18.487624872800588], [16.359003250924168, 16.569441396457385, 18.138951873968693], [15.676851490590755, 15.926715859575896, 17.7902788751368], [14.994699730257343, 15.283990322694406, 17.441605876304905], [14.312547969923932, 14.641264785812915, 17.09293287747301], [13.63039620959052, 13.998539248931424, 16.744259878641117], [12.948244449257109, 13.355813712049933, 16.395586879809223], [12.266092688923697, 12.713088175168442, 16.04691388097733], [11.583940928590286, 12.070362638286952, 15.698240882145432], [10.901789168256874, 11.42763710140546, 15.349567883313538], [10.219637407923463, 10.78491156452397, 15.000894884481642], [9.537485647590051, 10.14218602764248, 14.652221885649748], [8.85533388725664, 9.499460490760988, 14.303548886817852], [8.173182126923228, 8.856734953879497, 13.954875887985956], [7.491030366589817, 8.214009416998007, 13.606202889154062], [6.910756849397002, 7.914304793313816, 12.848931614255168], [6.434001904775508, 7.146969310597584, 12.420094839078875], [5.946356410205816, 7.7132425176007455, 11.755612689840662], [5.94596789319253, 7.646734503191732, 10.75782687461081], [5.399948552143502, 7.996470126547371, 9.996546457841518], [5.099225853679228, 7.605686057375425, 9.126573084737617], [4.428729264424136, 7.047973743700865, 8.637296783479261], [3.9606467637387475, 6.292190108733301, 8.179377718941291], [3.971942890620466, 5.347164650118723, 7.852576127623596], [3.3278062623191853, 4.758295525625584, 7.364394646717834], [2.6836696340179045, 4.169426401132446, 6.876213165812072], [2.0395330057166237, 3.580557276639308, 6.388031684906311], [2.3177087711590234, 3.5504691620761197, 5.427972859165634], [1.6908168642188757, 2.9672824233328288, 4.911349432705984], [1.063924957278728, 2.384095684589538, 4.3947260062463345], [0.9024397447451649, 1.760072196465579, 3.630188752476057], [1.0113451341539643, 2.0434446230955183, 2.677382537139708], [1.5298566888055696, 1.521052558992392, 2.0004391871798677], [0.9476979833544055, 0.9386163570037993, 1.4331127271231137], [0.5773502691896257, 0.5773502691896257, 0.5773502691896257], [0, 0, 0]]


def smooth(path, weight_data=0.1, weight_smooth=0.2, tolerance=0.000001):
    """
    Creates a smooth path for a n-dimensional series of coordinates.
    Arguments:
        path: List containing coordinates of a path
        weight_data: Float, how much weight to update the data (alpha)
        weight_smooth: Float, how much weight to smooth the coordinates (beta).
        tolerance: Float, how much change per iteration is necessary to keep iterating.
    Output:
        new: List containing smoothed coordinates.
    """

    new = deepcopy(path)
    dims = len(path[0])
    change = tolerance

    while change >= tolerance:
        change = 0.0
        for i in range(1, len(new) - 1):
            for j in range(dims):

                x_i = path[i][j]
                y_i, y_prev, y_next = new[i][j], new[i - 1][j], new[i + 1][j]

                y_i_saved = y_i
                y_i += weight_data * (x_i - y_i) + weight_smooth * (y_next + y_prev - (2 * y_i))
                new[i][j] = y_i

                change += abs(y_i - y_i_saved)

    return new


